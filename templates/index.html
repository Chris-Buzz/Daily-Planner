<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planno - Your Daily Planning Assistant</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='PlannerIcon.png') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='PlannerIcon.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='manifest.webmanifest') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.12/css/weather-icons.min.css">
    <link rel="stylesheet" href="static/styles.css">
</head>
<body>
    <!-- Loading Screen -->
    <div class="loader" id="loader">
        <div class="loader-ring"></div>
    </div>

    <!-- Main App -->
    <div class="app">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <button class="sidebar-toggle" id="sidebar-toggle" title="Toggle Sidebar">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <div class="logo">Planno</div>
                <div class="sidebar-actions">
                    <button class="icon-btn" id="calendar-btn" title="Open Calendar">
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none"/>
                            <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                            <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                            <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div class="week-nav">
                <button class="week-nav-btn" id="prev-week" title="Previous Week">
                    <svg viewBox="0 0 24 24" width="16" height="16">
                        <polyline points="15 18 9 12 15 6" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                </button>
                <span class="week-label" id="week-label">This Week</span>
                <button class="week-nav-btn" id="next-week" title="Next Week">
                    <svg viewBox="0 0 24 24" width="16" height="16">
                        <polyline points="9 18 15 12 9 6" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                </button>
            </div>

            <ul class="days-list" id="days-list">
                <li class="day-item active" data-day="Sunday">
                    <div class="day-info">
                        <span class="day-name">Sunday</span>
                        <span class="task-count">0 tasks</span>
                    </div>
                    <div class="day-weather" data-day="Sunday">
                        <i class="wi wi-day-sunny weather-icon"></i>
                        <span class="weather-temp">--°</span>
                    </div>
                </li>
                <li class="day-item" data-day="Monday">
                    <div class="day-info">
                        <span class="day-name">Monday</span>
                        <span class="task-count">0 tasks</span>
                    </div>
                    <div class="day-weather" data-day="Monday">
                        <i class="wi wi-day-sunny weather-icon"></i>
                        <span class="weather-temp">--°</span>
                    </div>
                </li>
                <li class="day-item" data-day="Tuesday">
                    <div class="day-info">
                        <span class="day-name">Tuesday</span>
                        <span class="task-count">0 tasks</span>
                    </div>
                    <div class="day-weather" data-day="Tuesday">
                        <i class="wi wi-day-sunny weather-icon"></i>
                        <span class="weather-temp">--°</span>
                    </div>
                </li>
                <li class="day-item" data-day="Wednesday">
                    <div class="day-info">
                        <span class="day-name">Wednesday</span>
                        <span class="task-count">0 tasks</span>
                    </div>
                    <div class="day-weather" data-day="Wednesday">
                        <i class="wi wi-day-sunny weather-icon"></i>
                        <span class="weather-temp">--°</span>
                    </div>
                </li>
                <li class="day-item" data-day="Thursday">
                    <div class="day-info">
                        <span class="day-name">Thursday</span>
                        <span class="task-count">0 tasks</span>
                    </div>
                    <div class="day-weather" data-day="Thursday">
                        <i class="wi wi-day-sunny weather-icon"></i>
                        <span class="weather-temp">--°</span>
                    </div>
                </li>
                <li class="day-item" data-day="Friday">
                    <div class="day-info">
                        <span class="day-name">Friday</span>
                        <span class="task-count">0 tasks</span>
                    </div>
                    <div class="day-weather" data-day="Friday">
                        <i class="wi wi-day-sunny weather-icon"></i>
                        <span class="weather-temp">--°</span>
                    </div>
                </li>
                <li class="day-item" data-day="Saturday">
                    <div class="day-info">
                        <span class="day-name">Saturday</span>
                        <span class="task-count">0 tasks</span>
                    </div>
                    <div class="day-weather" data-day="Saturday">
                        <i class="wi wi-day-sunny weather-icon"></i>
                        <span class="weather-temp">--°</span>
                    </div>
                </li>
            </ul>

            <!-- Event Recommendations Section -->
            <div class="recommendations-section" id="recommendations-section">
                <div class="recommendations-header">
                    <button class="toggle-recommendations" id="toggle-recommendations-btn" title="Toggle Recommendations">
                        <h3>For You</h3>
                        <svg class="toggle-icon" viewBox="0 0 24 24" width="18" height="18">
                            <polyline points="6 9 12 15 18 9" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                    </button>
                    <button class="icon-btn refresh-recommendations" id="refresh-recommendations-btn" title="Refresh Recommendations">
                        <svg viewBox="0 0 24 24" width="16" height="16">
                            <polyline points="23 4 23 10 17 10" stroke="currentColor" stroke-width="2" fill="none"/>
                            <polyline points="1 20 1 14 7 14" stroke="currentColor" stroke-width="2" fill="none"/>
                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                    </button>
                </div>
                <div class="recommendations-content" id="recommendations-content">
                    <div class="loading-recommendations">
                        <div class="loading-spinner"></div>
                        <p>Loading recommendations...</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-header">
                <div class="date-display">
                    <h1 class="current-day" id="current-day">Monday</h1>
                    <p class="current-date" id="current-date"></p>
                </div>
                <div class="header-actions">
                    <button class="icon-btn weather-btn" id="weather-btn" title="Check Weather">
                        <div class="weather-display">
                            <i class="wi wi-day-sunny" id="weather-icon"></i>
                            <span class="weather-temp" id="weather-temp">--°</span>
                        </div>
                    </button>
                    <button class="primary-btn" id="add-task-btn">
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2"/>
                            <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        Add Task
                    </button>
                    <button class="secondary-btn" id="delete-all-today-btn" title="Delete all tasks for today">
                        <svg viewBox="0 0 24 24" width="18" height="18">
                            <polyline points="3,6 5,6 21,6" stroke="currentColor" stroke-width="2" fill="none"/>
                            <path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2" stroke="currentColor" stroke-width="2" fill="none"/>
                            <line x1="10" y1="11" x2="10" y2="17" stroke="currentColor" stroke-width="2"/>
                            <line x1="14" y1="11" x2="14" y2="17" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        Delete All Today
                    </button>
                    <button class="icon-btn" id="settings-btn" title="Notification Settings">
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" fill="none"/>
                            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                    </button>
                    
                    <!-- Preferences Tooltip (shows when user has no preferences) -->
                    <div id="preferences-tooltip" class="preferences-tooltip" style="display: none;">
                        <div class="tooltip-content">
                            👋 Add your personal preferences here!
                        </div>
                        <div class="tooltip-arrow"></div>
                    </div>

                    <button class="theme-toggle" id="theme-toggle" title="Toggle Theme">
                        <svg class="sun-icon" viewBox="0 0 24 24" width="20" height="20">
                            <circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2" fill="none"/>
                            <line x1="12" y1="1" x2="12" y2="3" stroke="currentColor" stroke-width="2"/>
                            <line x1="12" y1="21" x2="12" y2="23" stroke="currentColor" stroke-width="2"/>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" stroke="currentColor" stroke-width="2"/>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2"/>
                            <line x1="1" y1="12" x2="3" y2="12" stroke="currentColor" stroke-width="2"/>
                            <line x1="21" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2"/>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" stroke="currentColor" stroke-width="2"/>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        <svg class="moon-icon" viewBox="0 0 24 24" width="20" height="20">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="tasks-container">
                <section class="task-section">
                    <div class="section-header">
                        <h3>Today's Tasks</h3>
                        <span class="task-badge" id="active-count">0</span>
                    </div>
                    <ul class="task-list" id="task-list">
                        <!-- Tasks will be rendered here -->
                    </ul>
                </section>

                <section class="task-section">
                    <div class="section-header">
                        <h3>Completed</h3>
                        <span class="task-badge completed" id="completed-count">0</span>
                        <button class="text-btn" id="clear-completed">Clear All</button>
                    </div>
                    <ul class="task-list" id="completed-list">
                        <!-- Completed tasks will be rendered here -->
                    </ul>
                </section>
            </div>
        </main>
    </div>

    <!-- Floating Action Buttons -->
    <div class="fab-container">
        <button class="fab-assistant" id="fab-assistant" title="Planning Assistant">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
        </button>
        
        <button class="fab-add" id="fab-add" title="Add Task">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2"/>
                <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2"/>
            </svg>
        </button>
    </div>

    <!-- Task Modal -->
    <div class="modal" id="task-modal" aria-hidden="true">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create Task</h2>
                <button class="modal-close" type="button" aria-label="Close">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            
            <form class="modal-form" id="task-form">
                <div class="form-group">
                    <label for="task-title">Task Title</label>
                    <input type="text" id="task-title" name="title" placeholder="What needs to be done?" required>
                </div>
                
                <div class="form-group">
                    <label for="task-description">Description</label>
                    <textarea id="task-description" name="description" placeholder="Add more details..."></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-start-time">Start Time (Optional)</label>
                        <input type="time" id="task-start-time" name="startTime">
                    </div>
                    <div class="form-group">
                        <label for="task-end-time">End Time *</label>
                        <input type="time" id="task-end-time" name="endTime" required>
                        <small class="form-help">If only end time is provided, task will be 1 hour long</small>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Select Days</label>
                    <div class="days-selector">
                        <label class="day-checkbox">
                            <input type="checkbox" name="days" value="Sunday">
                            <span>Sun</span>
                        </label>
                        <label class="day-checkbox">
                            <input type="checkbox" name="days" value="Monday" checked>
                            <span>Mon</span>
                        </label>
                        <label class="day-checkbox">
                            <input type="checkbox" name="days" value="Tuesday">
                            <span>Tue</span>
                        </label>
                        <label class="day-checkbox">
                            <input type="checkbox" name="days" value="Wednesday">
                            <span>Wed</span>
                        </label>
                        <label class="day-checkbox">
                            <input type="checkbox" name="days" value="Thursday">
                            <span>Thu</span>
                        </label>
                        <label class="day-checkbox">
                            <input type="checkbox" name="days" value="Friday">
                            <span>Fri</span>
                        </label>
                        <label class="day-checkbox">
                            <input type="checkbox" name="days" value="Saturday">
                            <span>Sat</span>
                        </label>
                    </div>
                    <button type="button" class="secondary-btn select-all-days-btn" id="select-all-days" style="margin-top: 12px; max-width: 200px;">
                        <svg viewBox="0 0 24 24" width="16" height="16" style="margin-right: 6px;">
                            <polyline points="20 6 9 17 4 12" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                        All Days
                    </button>
                    <small class="form-help">Select one or more days for this task</small>
                </div>
                
                <div class="form-group">
                    <label for="task-priority">Priority</label>
                    <select id="task-priority" name="priority">
                        <option value="low">Low</option>
                        <option value="medium" selected>Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Color</label>
                    <div class="color-picker">
                        <input type="radio" id="color-none" name="color" value="" checked>
                        <label class="color-option" for="color-none" data-color="none"></label>
                        
                        <input type="radio" id="color-blue" name="color" value="#4285F4">
                        <label class="color-option color-blue" for="color-blue"></label>
                        
                        <input type="radio" id="color-red" name="color" value="#EA4335">
                        <label class="color-option color-red" for="color-red"></label>
                        
                        <input type="radio" id="color-yellow" name="color" value="#FBBC05">
                        <label class="color-option color-yellow" for="color-yellow"></label>
                        
                        <input type="radio" id="color-green" name="color" value="#34A853">
                        <label class="color-option color-green" for="color-green"></label>
                        
                        <input type="radio" id="color-purple" name="color" value="#8E24AA">
                        <label class="color-option color-purple" for="color-purple"></label>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="secondary-btn modal-cancel">Cancel</button>
                    <button type="submit" class="primary-btn">Create Task</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Calendar Modal -->
    <div class="modal calendar-modal" id="calendar-modal" aria-hidden="true">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="calendar-controls">
                <h2 class="calendar-month" id="calendar-month">Week View</h2>
                <div class="calendar-nav">
                    <button class="secondary-btn" id="calendar-prev">
                        <svg viewBox="0 0 24 24" width="16" height="16">
                            <polyline points="15 18 9 12 15 6" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                        Previous
                    </button>
                    <button class="secondary-btn" id="calendar-next">
                        Next
                        <svg viewBox="0 0 24 24" width="16" height="16">
                            <polyline points="9 18 15 12 9 6" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                    </button>
                </div>
                <button class="modal-close" type="button" aria-label="Close">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            
            <div class="calendar-container">
                <div class="calendar-grid-container">
                    <div class="calendar-grid" id="calendar-grid">
                        <!-- Calendar will be rendered here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Professional Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content settings-modal-content">
            <div class="settings-header">
                <div class="header-info">
                    <div class="header-icon">
                        ⚙️
                    </div>
                    <div class="header-text">
                        <h2>Settings</h2>
                        <p>Customize your notification preferences</p>
                    </div>
                </div>
                <button class="close-btn" type="button" aria-label="Close">
                    ✕
                </button>
            </div>
            
            <!-- Settings Tab Navigation -->
            <div class="settings-tabs">
                <button class="settings-tab-btn active" data-tab="notifications">
                    🔔
                    <span>Notifications</span>
                </button>
                <button class="settings-tab-btn" data-tab="preferences">
                    ⭐
                    <span>AI Preferences</span>
                </button>
                <button class="settings-tab-btn" data-tab="classes">
                    📅
                    <span>Class Schedule</span>
                </button>
            </div>
            
            <div class="settings-body">
                <!-- Notifications Tab Content -->
                <div class="settings-tab-content active" id="notifications-tab">
                    <!-- Notification Toggle Section -->
                    <div class="notification-toggle-section">
                        <div class="toggle-card">
                            <div class="toggle-main">
                                <div class="toggle-info">
                                    <div class="toggle-icon">
                                        🔔
                                    </div>
                                    <div class="toggle-details">
                                        <h3>Smart Notifications</h3>
                                        <p>Get reminded about your tasks and daily progress</p>
                                    </div>
                                </div>
                                <label class="master-toggle" title="Enable or disable notifications">
                                    <input type="checkbox" id="notifications-enabled" aria-label="Enable notifications" />
                                    <span class="toggle-track">
                                        <span class="toggle-thumb"></span>
                                    </span>
                                </label>
                            </div>
                            <div class="status-bar" id="notification-status">
                                <div class="status-indicator">
                                    <span class="status-dot"></span>
                                    <span class="status-text">Notifications disabled</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Content -->
                    <div class="settings-content hidden" id="settings-content">
                    
                    <!-- Contact Information -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h4>📧 Contact Information</h4>
                            <p>Choose how you'd like to receive notifications</p>
                        </div>
                        
                        <div class="form-group">
                            <label for="notification-email">Email Address</label>
                            <div class="input-field">
                                <span class="input-icon">
                                    📧
                                </span>
                                <input type="email" id="notification-email" placeholder="your.email@example.com" />
                                <span class="field-status" id="email-status"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Timezone Settings -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h4>🌍 Your Timezone</h4>
                            <p>Set your timezone so notifications arrive at the right time for you</p>
                        </div>

                        <div class="form-group">
                            <label for="user-timezone">Timezone (Auto-detected)</label>
                            <div class="input-field timezone-field">
                                <select id="user-timezone" class="timezone-select">
                                    <optgroup label="🇺🇸 United States">
                                        <option value="America/New_York">Eastern Time (ET)</option>
                                        <option value="America/Chicago">Central Time (CT)</option>
                                        <option value="America/Denver">Mountain Time (MT)</option>
                                        <option value="America/Los_Angeles">Pacific Time (PT)</option>
                                        <option value="America/Anchorage">Alaska Time (AKT)</option>
                                        <option value="Pacific/Honolulu">Hawaii Time (HT)</option>
                                        <option value="America/Phoenix">Arizona Time (MST - No DST)</option>
                                    </optgroup>
                                    <optgroup label="🇨🇦 Canada">
                                        <option value="America/Toronto">Toronto (ET)</option>
                                        <option value="America/Vancouver">Vancouver (PT)</option>
                                        <option value="America/Halifax">Halifax (AT)</option>
                                    </optgroup>
                                    <optgroup label="🇬🇧 Europe">
                                        <option value="Europe/London">London (GMT/BST)</option>
                                        <option value="Europe/Paris">Paris (CET/CEST)</option>
                                        <option value="Europe/Berlin">Berlin (CET/CEST)</option>
                                        <option value="Europe/Rome">Rome (CET/CEST)</option>
                                        <option value="Europe/Madrid">Madrid (CET/CEST)</option>
                                        <option value="Europe/Amsterdam">Amsterdam (CET/CEST)</option>
                                    </optgroup>
                                    <optgroup label="🌏 Asia">
                                        <option value="Asia/Dubai">Dubai (GST)</option>
                                        <option value="Asia/Kolkata">India (IST)</option>
                                        <option value="Asia/Shanghai">Shanghai (CST)</option>
                                        <option value="Asia/Hong_Kong">Hong Kong (HKT)</option>
                                        <option value="Asia/Tokyo">Tokyo (JST)</option>
                                        <option value="Asia/Seoul">Seoul (KST)</option>
                                        <option value="Asia/Singapore">Singapore (SGT)</option>
                                    </optgroup>
                                    <optgroup label="🌏 Australia & Pacific">
                                        <option value="Australia/Sydney">Sydney (AEDT/AEST)</option>
                                        <option value="Australia/Melbourne">Melbourne (AEDT/AEST)</option>
                                        <option value="Australia/Perth">Perth (AWST)</option>
                                        <option value="Pacific/Auckland">Auckland (NZDT/NZST)</option>
                                    </optgroup>
                                    <optgroup label="🌎 Latin America">
                                        <option value="America/Mexico_City">Mexico City (CST)</option>
                                        <option value="America/Sao_Paulo">São Paulo (BRT)</option>
                                        <option value="America/Buenos_Aires">Buenos Aires (ART)</option>
                                    </optgroup>
                                </select>
                                <span class="field-status" id="timezone-status"></span>
                            </div>
                            <p class="field-hint">🌍 Auto-detected from your browser. Notifications will be sent based on your local time.</p>
                        </div>
                    </div>

                    <!-- Notification Methods -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h4>📬 Delivery Methods</h4>
                            <p>Select how you want to receive notifications (you can choose multiple)</p>
                        </div>
                        
                        <div class="method-grid">
                            <label class="method-option">
                                <input type="checkbox" name="notification-methods" value="email" id="method-email" checked />
                                <div class="method-card">
                                    <div class="method-icon">
                                        📧
                                    </div>
                                    <div class="method-info">
                                        <h5>Email</h5>
                                        <p>Rich notifications with task details</p>
                                    </div>
                                    <div class="method-check">
                                        ✓
                                    </div>
                                </div>
                            </label>
                            
                            <label class="method-option">
                                <input type="checkbox" name="notification-methods" value="push" id="method-push" />
                                <div class="method-card">
                                    <div class="method-icon">
                                        🔔
                                    </div>
                                    <div class="method-info">
                                        <h5>Push Notifications</h5>
                                        <p>Browser alerts even when app is closed</p>
                                    </div>
                                    <div class="method-check">
                                        ✓
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Preferences -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h4>
                                ⚙️ Preferences
                            </h4>
                            <p>Customize when and what notifications you receive</p>
                        </div>
                        
                        <!-- Custom Notification Timing Section -->
                        <div class="notification-timing-section">
                            <div class="timing-section-header">
                                <h4>
                                    ⏰ Notification Timing
                                </h4>
                                <p>Customize when you receive task reminders and daily summaries</p>
                            </div>
                            
                            <div class="reminder-times-container">
                                <div class="reminder-times-header">
                                    <h5>
                                        ⏰ Reminder Times
                                    </h5>
                                    <div class="add-reminder-dropdown">
                                        <button id="add-reminder-btn" class="add-reminder-btn">
                                            ➕ Add Reminder
                                        </button>
                                        <div class="add-reminder-menu">
                                            <div class="add-reminder-quick-options">
                                                <button class="quick-reminder-btn" data-minutes="5">5 minutes</button>
                                                <button class="quick-reminder-btn" data-minutes="15">15 minutes</button>
                                                <button class="quick-reminder-btn" data-minutes="30">30 minutes</button>
                                                <button class="quick-reminder-btn" data-minutes="60">1 hour</button>
                                                <button class="quick-reminder-btn" data-minutes="120">2 hours</button>
                                                <button class="quick-reminder-btn" data-minutes="300">5 hours</button>
                                                <button class="quick-reminder-btn" data-minutes="720">12 hours</button>
                                                <button class="quick-reminder-btn" data-minutes="1440">1 day</button>
                                            </div>
                                            <div class="add-reminder-custom">
                                                <h6>Custom Time</h6>
                                                <div class="custom-reminder-form">
                                                    <input type="number" id="custom-reminder-value" placeholder="1" min="1" max="9999" aria-label="Custom reminder time value">
                                                    <select id="custom-reminder-unit" aria-label="Time unit for custom reminder">
                                                        <option value="minutes">Minutes</option>
                                                        <option value="hours">Hours</option>
                                                        <option value="days">Days</option>
                                                    </select>
                                                    <button id="add-custom-reminder-btn" type="button">Add</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="reminder-times-list" id="reminder-times-list">
                                    <!-- Dynamic reminder time items will be added here -->
                                </div>
                            </div>
                            
                            <div class="daily-summary-container">
                                <div class="daily-summary-header">
                                    <h5>
                                        📝 Daily Summary Time
                                    </h5>
                                    <p>Choose when to receive your daily task summary</p>
                                </div>
                                
                                <div class="daily-summary-time-selector">
                                    <label for="daily-summary-time">
                                        ⏰ Send daily summary at:
                                    </label>
                                    <input type="time" id="daily-summary-time" value="23:30" />
                                </div>
                            </div>
                        </div>
                        
                        <div class="preference-list">
                            <div class="preference-item">
                                <div class="pref-info">
                                    <div class="pref-icon">📊</div>
                                    <div class="pref-details">
                                        <h5>Daily Summary</h5>
                                        <p>Enable evening recap of your completed tasks</p>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="daily-summary" aria-label="Enable daily summary notifications" checked />
                                    <span class="switch-track">
                                        <span class="switch-thumb"></span>
                                    </span>
                                </label>
                            </div>

                            <div class="preference-item">
                                <div class="pref-info">
                                    <div class="pref-icon">✨</div>
                                    <div class="pref-details">
                                        <h5>Auto Inspiration</h5>
                                        <p>Receive sporadic motivational messages throughout the day</p>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="auto-inspiration" aria-label="Enable automatic inspiration messages" />
                                    <span class="switch-track">
                                        <span class="switch-thumb"></span>
                                    </span>
                                </label>
                            </div>

                            <div class="preference-item">
                                <div class="pref-info">
                                    <div class="pref-icon">💫</div>
                                    <div class="pref-details">
                                        <h5>Manual Inspiration</h5>
                                        <p>Get a motivational message right now</p>
                                    </div>
                                </div>
                                <button type="button" id="send-inspiration-btn" class="action-btn secondary">
                                    <span>✨ Send Now</span>
                                </button>
                            </div>

                            <div class="preference-item">
                                <div class="pref-info">
                                    <div class="pref-icon">🗑️</div>
                                    <div class="pref-details">
                                        <h5>Auto-Delete Old Tasks</h5>
                                        <p>Automatically remove completed tasks after a set time to save storage</p>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="auto-cleanup" aria-label="Enable automatic cleanup of old tasks" />
                                    <span class="switch-track">
                                        <span class="switch-thumb"></span>
                                    </span>
                                </label>
                            </div>

                            <div class="preference-item hidden" id="cleanup-weeks-setting">
                                <div class="pref-info">
                                    <div class="pref-icon">📅</div>
                                    <div class="pref-details">
                                        <h5>Keep Tasks For</h5>
                                        <p>How long to keep completed tasks before deletion</p>
                                    </div>
                                </div>
                                <select id="cleanup-weeks" class="select-field" title="Set how long to keep completed tasks">
                                    <option value="1">1 week</option>
                                    <option value="2" selected>2 weeks</option>
                                    <option value="4">1 month</option>
                                    <option value="8">2 months</option>
                                    <option value="12">3 months</option>
                                </select>
                            </div>
                            
                            <div id="inspiration-message" class="inspiration-display hidden"></div>
                        </div>
                    </div>

                    <!-- Test Section -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h4>
                                🧪 Test Your Setup
                            </h4>
                            <p>Make sure everything works perfectly</p>
                        </div>
                        
                        <div class="test-actions">
                            <button type="button" id="test-notification-btn" class="test-btn">
                                <span class="btn-icon">
                                    ✅
                                </span>
                                <span class="btn-text">
                                    <strong>Connection Test</strong>
                                    <small>Verify your settings</small>
                                </span>
                            </button>

                            <button type="button" id="test-task-reminder-btn" class="test-btn">
                                <span class="btn-icon">
                                    ⏰
                                </span>
                                <span class="btn-text">
                                    <strong>Task Reminder</strong>
                                    <small>Preview format</small>
                                </span>
                            </button>

                            <button type="button" id="test-daily-summary-btn" class="test-btn">
                                <span class="btn-icon">
                                    📊
                                </span>
                                <span class="btn-text">
                                    <strong>Daily Summary</strong>
                                    <small>Preview email</small>
                                </span>
                            </button>
                        </div>

                        <div class="test-status" id="test-status">
                            <div class="status-item">
                                <span class="label">Last Test:</span>
                                <span class="value" id="last-test-time">Never</span>
                            </div>
                            <div class="status-item">
                                <span class="label">Result:</span>
                                <span class="value" id="test-result">Ready to test</span>
                            </div>
                        </div>
                    </div>
                </div>
                </div> <!-- End notifications tab -->

                <!-- AI Preferences Tab Content -->
                <div class="settings-tab-content" id="preferences-tab">
                    <div class="preferences-section">
                        <div class="section-header">
                            <h4>
                                🤖 AI Preferences & Learning
                            </h4>
                            <p>Tell us about your interests so we can provide personalized recommendations</p>
                        </div>

                        <!-- Privacy & Auto-fill Controls -->
                        <div class="pref-group" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; margin-bottom: 25px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <div>
                                    <label style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 5px; display: block;">
                                        🔒 Privacy Mode
                                    </label>
                                    <p class="pref-hint" style="margin: 0;">Disable all preference tracking and personalized suggestions</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="privacy-mode-toggle" aria-label="Enable privacy mode" />
                                    <span class="switch-track">
                                        <span class="switch-thumb"></span>
                                    </span>
                                </label>
                            </div>
                            <div id="privacy-notice" style="display: none; background: rgba(255,193,7,0.1); border-left: 3px solid #FFC107; padding: 12px; border-radius: 6px; margin-top: 12px;">
                                <p style="margin: 0; font-size: 13px; color: #FFC107;">
                                    🔒 <strong>Privacy Mode Active:</strong> We won't track your preferences or task patterns. The "For You" suggestions panel is hidden.
                                </p>
                            </div>
                        </div>

                        <!-- Auto-fill from Tasks -->
                        <div class="pref-group" id="autofill-section" style="background: rgba(76,175,80,0.05); border: 1px solid rgba(76,175,80,0.2); border-radius: 12px; padding: 20px; margin-bottom: 25px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="flex: 1;">
                                    <label style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 5px; display: block;">
                                        ✨ Auto-Fill Preferences
                                    </label>
                                    <p class="pref-hint" style="margin: 0;">Let AI analyze your past tasks to discover what you enjoy and automatically fill in your preferences</p>
                                </div>
                                <button class="btn-primary" id="autofill-preferences-btn" style="margin-left: 15px; white-space: nowrap; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; transition: all 0.3s ease;">
                                    ⚡ Auto-Fill
                                </button>
                            </div>
                            <div id="autofill-status" style="display: none; margin-top: 12px; padding: 10px; background: rgba(76,175,80,0.1); border-radius: 6px;">
                                <p style="margin: 0; font-size: 13px; color: #4CAF50;"></p>
                            </div>
                        </div>

                        <!-- Preference Fields Container (hidden when privacy mode is on) -->
                        <div id="preference-fields-container">

                        <!-- LOCATION & SEARCH SECTION -->
                        <div class="pref-category-header">
                            <h5>📍 Location & Search Radius</h5>
                            <p>Set your location to discover nearby places and events</p>
                        </div>

                        <!-- Location Input -->
                        <div class="pref-group">
                            <label for="location-input">Your Location</label>
                            <p class="pref-hint">We'll use this to find nearby places and events</p>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input 
                                    type="text" 
                                    id="location-input" 
                                    placeholder="e.g., New York, NY" 
                                    style="flex: 1; padding: 10px; border: 1px solid rgba(148,163,184,0.3); border-radius: 8px; background: var(--bg-secondary); color: var(--text-primary);"
                                />
                                <button 
                                    type="button" 
                                    id="detect-location-btn" 
                                    class="btn-secondary"
                                    style="padding: 10px 15px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; white-space: nowrap; display: flex; align-items: center; gap: 5px;"
                                >
                                    <svg viewBox="0 0 24 24" width="18" height="18">
                                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <circle cx="12" cy="12" r="3" fill="currentColor"/>
                                    </svg>
                                    Detect
                                </button>
                            </div>
                        </div>

                        <!-- Event Search Radius -->
                        <div class="pref-group">
                            <label for="event-radius">Search Radius</label>
                            <p class="pref-hint">How far are you willing to travel for activities?</p>
                            <div class="radius-selector">
                                <input type="range" id="event-radius" min="1" max="20" value="10" step="1" class="radius-slider" />
                                <div class="radius-display">
                                    <span id="radius-value">10</span> miles
                                </div>
                            </div>
                        </div>

                        <!-- Daily Schedule -->
                        <div class="pref-group">
                            <label>⏰ Daily Schedule</label>
                            <p class="pref-hint">When do you typically wake up and go to bed?</p>
                            <div class="schedule-inputs">
                                <div class="schedule-item">
                                    <label for="wake-time">Wake Up Time</label>
                                    <input type="time" id="wake-time" value="07:00" />
                                </div>
                                <div class="schedule-item">
                                    <label for="bed-time">Bedtime</label>
                                    <input type="time" id="bed-time" value="23:00" />
                                </div>
                            </div>
                        </div>

                        <!-- FOOD & DINING SECTION -->
                        <div class="pref-category-header" style="margin-top: 30px; padding-top: 30px; border-top: 2px solid rgba(255,255,255,0.1);">
                            <h5>🍽️ Food & Dining</h5>
                            <p>Your culinary preferences and dining habits</p>
                        </div>

                        <!-- Cuisine Preferences -->
                        <div class="pref-group">
                            <label>Favorite Cuisines</label>
                            <p class="pref-hint">What types of food do you enjoy? (press Enter after each)</p>
                            <div class="tag-input-container">
                                <div class="tags-display" id="cuisine-tags"></div>
                                <input type="text" id="cuisine-input" class="tag-input" placeholder="e.g., Italian, Thai, Mexican..." />
                            </div>
                            <div class="quick-tags">
                                <span class="quick-tag" data-group="cuisine" data-value="italian">🍝 Italian</span>
                                <span class="quick-tag" data-group="cuisine" data-value="mexican">🌮 Mexican</span>
                                <span class="quick-tag" data-group="cuisine" data-value="chinese">🥡 Chinese</span>
                                <span class="quick-tag" data-group="cuisine" data-value="japanese">🍱 Japanese</span>
                                <span class="quick-tag" data-group="cuisine" data-value="thai">🍜 Thai</span>
                                <span class="quick-tag" data-group="cuisine" data-value="indian">🍛 Indian</span>
                                <span class="quick-tag" data-group="cuisine" data-value="american">🍔 American</span>
                                <span class="quick-tag" data-group="cuisine" data-value="mediterranean">🥙 Mediterranean</span>
                            </div>
                        </div>

                        <!-- Dietary Restrictions -->
                        <div class="pref-group">
                            <label>Dietary Restrictions</label>
                            <p class="pref-hint">Any dietary needs or preferences? (press Enter after each)</p>
                            <div class="tag-input-container">
                                <div class="tags-display" id="dietary-tags"></div>
                                <input type="text" id="dietary-input" class="tag-input" placeholder="e.g., vegetarian, gluten-free..." />
                            </div>
                            <div class="quick-tags">
                                <span class="quick-tag" data-group="dietary" data-value="vegetarian">🥗 Vegetarian</span>
                                <span class="quick-tag" data-group="dietary" data-value="vegan">🌱 Vegan</span>
                                <span class="quick-tag" data-group="dietary" data-value="gluten-free">🌾 Gluten-Free</span>
                                <span class="quick-tag" data-group="dietary" data-value="dairy-free">🥛 Dairy-Free</span>
                                <span class="quick-tag" data-group="dietary" data-value="halal">☪️ Halal</span>
                                <span class="quick-tag" data-group="dietary" data-value="kosher">✡️ Kosher</span>
                            </div>
                        </div>

                        <!-- Pet Friendly Preferences -->
                        <div class="pref-group">
                            <label>Pet-Friendly Dining</label>
                            <p class="pref-hint">Do you prefer pet-friendly restaurants?</p>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="has-dog" />
                                    <span>🐕 I have a dog</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="has-cat" />
                                    <span>🐈 I have a cat</span>
                                </label>
                            </div>
                        </div>

                        <!-- Price Range -->
                        <div class="pref-group">
                            <label>Price Range Preference</label>
                            <p class="pref-hint">What's your typical dining budget?</p>
                            <select id="price-range" class="pref-select">
                                <option value="">Any Price Range</option>
                                <option value="1">💰 Budget-Friendly ($)</option>
                                <option value="2">💰💰 Moderate ($$)</option>
                                <option value="3">💰💰💰 Upscale ($$$)</option>
                                <option value="4">💰💰💰💰 Fine Dining ($$$$)</option>
                            </select>
                        </div>

                        <!-- INTERESTS & HOBBIES SECTION -->
                        <div class="pref-category-header" style="margin-top: 30px; padding-top: 30px; border-top: 2px solid rgba(255,255,255,0.1);">
                            <h5>🎯 Interests & Hobbies</h5>
                            <p>Help us understand what you love to do</p>
                        </div>

                        <!-- Hobbies & Interests -->
                        <div class="pref-group">
                            <label>Hobbies & Interests</label>
                            <p class="pref-hint">Add activities you enjoy (press Enter after each)</p>
                            <div class="tag-input-container">
                                <div class="tags-display" id="hobbies-tags"></div>
                                <input type="text" id="hobbies-input" class="tag-input" placeholder="e.g., basketball, painting, reading..." />
                            </div>
                            <div class="quick-tags">
                                <span class="quick-tag" data-group="hobbies" data-value="basketball">🏀 Basketball</span>
                                <span class="quick-tag" data-group="hobbies" data-value="soccer">⚽ Soccer</span>
                                <span class="quick-tag" data-group="hobbies" data-value="reading">📚 Reading</span>
                                <span class="quick-tag" data-group="hobbies" data-value="painting">🎨 Painting</span>
                                <span class="quick-tag" data-group="hobbies" data-value="gaming">🎮 Gaming</span>
                                <span class="quick-tag" data-group="hobbies" data-value="cooking">🍳 Cooking</span>
                            </div>
                        </div>

                        <!-- WELLNESS & FITNESS SECTION -->
                        <div class="pref-category-header" style="margin-top: 30px; padding-top: 30px; border-top: 2px solid rgba(255,255,255,0.1);">
                            <h5>💪 Wellness & Fitness</h5>
                            <p>Your fitness and workout preferences</p>
                        </div>

                        <!-- Workout Styles -->
                        <div class="pref-group">
                            <label>Workout Styles</label>
                            <p class="pref-hint">What types of exercise do you prefer?</p>
                            <div class="tag-input-container">
                                <div class="tags-display" id="workout-tags"></div>
                                <input type="text" id="workout-input" class="tag-input" placeholder="e.g., cardio, strength training..." />
                            </div>
                            <div class="quick-tags">
                                <span class="quick-tag" data-group="workouts" data-value="cardio">💓 Cardio</span>
                                <span class="quick-tag" data-group="workouts" data-value="strength">💪 Strength</span>
                                <span class="quick-tag" data-group="workouts" data-value="yoga">🧘 Yoga</span>
                                <span class="quick-tag" data-group="workouts" data-value="hiit">🔥 HIIT</span>
                                <span class="quick-tag" data-group="workouts" data-value="pilates">🤸 Pilates</span>
                                <span class="quick-tag" data-group="workouts" data-value="running">🏃 Running</span>
                            </div>
                        </div>

                        <!-- ACTIVITIES SECTION -->
                        <div class="pref-category-header" style="margin-top: 30px; padding-top: 30px; border-top: 2px solid rgba(255,255,255,0.1);">
                            <h5>🎪 Activities</h5>
                            <p>Indoor and outdoor activities you enjoy</p>
                        </div>

                        <!-- Indoor Activities -->
                        <div class="pref-group">
                            <label>Indoor Activities</label>
                            <p class="pref-hint">What indoor activities do you enjoy?</p>
                            <div class="tag-input-container">
                                <div class="tags-display" id="indoor-tags"></div>
                                <input type="text" id="indoor-input" class="tag-input" placeholder="e.g., museums, shopping..." />
                            </div>
                            <div class="quick-tags">
                                <span class="quick-tag" data-group="indoor" data-value="museums">🏛️ Museums</span>
                                <span class="quick-tag" data-group="indoor" data-value="shopping">🛍️ Shopping</span>
                                <span class="quick-tag" data-group="indoor" data-value="theaters">🎭 Theaters</span>
                                <span class="quick-tag" data-group="indoor" data-value="arcades">🕹️ Arcades</span>
                                <span class="quick-tag" data-group="indoor" data-value="bowling">🎳 Bowling</span>
                                <span class="quick-tag" data-group="indoor" data-value="climbing">🧗 Indoor Climbing</span>
                                <span class="quick-tag" data-group="indoor" data-value="escape-rooms">🔐 Escape Rooms</span>
                            </div>
                        </div>

                        <!-- Outdoor Activities -->
                        <div class="pref-group">
                            <label>Outdoor Activities</label>
                            <p class="pref-hint">What outdoor activities do you like?</p>
                            <div class="tag-input-container">
                                <div class="tags-display" id="outdoor-tags"></div>
                                <input type="text" id="outdoor-input" class="tag-input" placeholder="e.g., hiking, beach..." />
                            </div>
                            <div class="quick-tags">
                                <span class="quick-tag" data-group="outdoor" data-value="hiking">🥾 Hiking</span>
                                <span class="quick-tag" data-group="outdoor" data-value="beach">🏖️ Beach</span>
                                <span class="quick-tag" data-group="outdoor" data-value="parks">🌳 Parks</span>
                                <span class="quick-tag" data-group="outdoor" data-value="cycling">🚴 Cycling</span>
                                <span class="quick-tag" data-group="outdoor" data-value="kayaking">🛶 Kayaking</span>
                                <span class="quick-tag" data-group="outdoor" data-value="camping">⛺ Camping</span>
                                <span class="quick-tag" data-group="outdoor" data-value="fishing">🎣 Fishing</span>
                            </div>
                        </div>

                        <!-- EVENTS & ENTERTAINMENT SECTION -->
                        <div class="pref-category-header" style="margin-top: 30px; padding-top: 30px; border-top: 2px solid rgba(255,255,255,0.1);">
                            <h5>🎭 Events & Entertainment</h5>
                            <p>What kind of events do you like to attend?</p>
                        </div>

                        <!-- Event Categories -->
                        <div class="pref-group">
                            <label>Favorite Event Types</label>
                            <p class="pref-hint">What kind of events interest you?</p>
                            <div class="tag-input-container">
                                <div class="tags-display" id="events-tags"></div>
                                <input type="text" id="events-input" class="tag-input" placeholder="e.g., concerts, sports games..." />
                            </div>
                            <div class="quick-tags">
                                <span class="quick-tag" data-group="events" data-value="concerts">🎵 Concerts</span>
                                <span class="quick-tag" data-group="events" data-value="sports">⚽ Sports</span>
                                <span class="quick-tag" data-group="events" data-value="theater">🎭 Theater</span>
                                <span class="quick-tag" data-group="events" data-value="comedy">😂 Comedy</span>
                                <span class="quick-tag" data-group="events" data-value="festivals">🎪 Festivals</span>
                                <span class="quick-tag" data-group="events" data-value="community">👥 Community</span>
                            </div>
                        </div>


                        </div> <!-- End preference-fields-container -->

                        <!-- Save Preferences Button -->
                        <div class="pref-actions" id="save-pref-actions">
                            <button class="btn-primary" id="save-preferences-btn">
                                <svg viewBox="0 0 24 24" width="18" height="18">
                                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" stroke="currentColor" stroke-width="2" fill="none"/>
                                    <polyline points="17 21 17 13 7 13 7 21" stroke="currentColor" stroke-width="2" fill="none"/>
                                    <polyline points="7 3 7 8 15 8" stroke="currentColor" stroke-width="2" fill="none"/>
                                </svg>
                                Save Preferences
                            </button>
                            <button class="btn-secondary" id="clear-preferences-btn">Clear All</button>
                        </div>
                    </div>
                </div>

                <!-- Class Schedule Tab Content -->
                <div class="settings-tab-content" id="classes-tab">
                    <div class="class-schedule-section">
                        <div class="section-header">
                            <h4>
                                📅 Class Schedule Management
                            </h4>
                            <p>Set up your semester and automatically add classes to your planner</p>
                        </div>

                        <!-- Semester Settings -->
                        <div class="semester-settings">
                            <h5>Semester Information</h5>
                            <div class="semester-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="semester-name">Semester Name</label>
                                        <input type="text" id="semester-name" placeholder="e.g., Fall 2025" />
                                    </div>
                                    <div class="form-group">
                                        <label for="semester-start">Start Date</label>
                                        <input type="date" id="semester-start" />
                                    </div>
                                    <div class="form-group">
                                        <label for="semester-end">End Date</label>
                                        <input type="date" id="semester-end" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Break Periods -->
                        <div class="break-periods-section">
                            <div class="section-sub-header">
                                <h5>☕ Break Periods (Optional)</h5>
                                <p>Classes won't be scheduled during these periods</p>
                                <button type="button" class="btn-add-break" id="add-break-btn">
                                    ➕ Add Break
                                </button>
                            </div>
                            <div class="break-periods-list" id="break-periods-list">
                                <!-- Break periods will be added here dynamically -->
                            </div>
                        </div>

                        <!-- Class Schedule -->
                        <div class="class-schedule-management">
                            <div class="section-sub-header">
                                <h5>📚 Classes</h5>
                                <p>Add your recurring classes for the semester</p>
                                <button type="button" class="btn-add-class" id="add-class-btn">
                                    ➕ Add Class
                                </button>
                            </div>
                            <div class="classes-list" id="classes-list">
                                <!-- Classes will be added here dynamically -->
                            </div>
                        </div>

                        <!-- Generation Actions -->
                        <div class="generation-actions">
                            <button type="button" class="btn-generate-schedule" id="generate-schedule-btn">
                                ✨ Generate Class Schedule
                            </button>
                            <button type="button" class="btn-clear-schedule" id="clear-schedule-btn">
                                🗑️ Clear Generated Classes
                            </button>
                        </div>
                    </div>
                </div> <!-- End class schedule tab -->

                <!-- Action Buttons -->
                <div class="settings-footer">
                    <button type="button" id="sign-out-btn" class="sign-out-btn">
                        <svg viewBox="0 0 24 24" width="18" height="18">
                            <path d="M17 7L15.59 8.41L17.17 10H9V12H17.17L15.59 13.59L17 15L21 11L17 7M4 5H12V3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H12V19H4V5Z" fill="currentColor"/>
                        </svg>
                        <span>Sign Out</span>
                    </button>
                    <button type="button" id="save-settings-btn" class="save-btn">
                        💾 <span>Save Settings</span>
                    </button>
                </div>
                
                <div class="settings-privacy-footer">
                    <a href="/privacy" target="_blank">Privacy Policy</a>
                </div>
                
                <div id="settings-status" class="feedback-message hidden"></div>
            </div>
        </div>
    </div>

    <!-- Weather Modal -->
    <div class="modal" id="weather-modal" aria-hidden="true">
        <div class="modal-overlay"></div>
        <div class="modal-content weather-modal-content">
            <div class="modal-header">
                <h2><i class="wi wi-day-sunny"></i> Weather</h2>
                <button class="modal-close" type="button" aria-label="Close">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            
            <!-- City Search Section (Always Visible) -->
            <div class="weather-search-section">
                <div class="search-row">
                    <div class="autocomplete-container">
                        <input type="text" id="weather-city-search" placeholder="Search for any city or enter zipcode..." class="city-search-input" autocomplete="off">
                        <div class="autocomplete-dropdown hidden" id="weather-search-dropdown"></div>
                    </div>
                    <button type="button" id="weather-search-btn" class="primary-btn">Search</button>
                </div>
                <p class="search-hint">💡 Enter a city name (e.g., "New York") or zipcode (e.g., "10001")</p>
            </div>
            
            <div class="weather-content">
                <div id="location-request" class="location-request">
                    <div class="location-icon">📍</div>
                    <h3>Location Access Needed</h3>
                    <p>Allow location access to get accurate weather for your area</p>
                    <button type="button" id="allow-location-btn" class="primary-btn">Allow Location Access</button>
                    <div class="manual-location">
                        <p>Or search manually:</p>
                        <div class="search-group autocomplete-container">
                            <input type="text" id="manual-city-input" placeholder="Enter city name..." class="city-search-input" autocomplete="off">
                            <div class="autocomplete-dropdown hidden" id="manual-autocomplete-dropdown"></div>
                            <button type="button" id="manual-search-btn" class="secondary-btn">Search</button>
                        </div>
                    </div>
                </div>
                
                <div id="weather-loading" class="weather-loading hidden">
                    <div class="loading-spinner"></div>
                    <p>Getting weather data...</p>
                </div>
                
                <div id="weather-data" class="weather-data hidden">
                    <!-- Current Weather -->
                    <div class="weather-current">
                        <div class="current-main">
                            <div class="current-icon">
                                <i class="wi" id="current-weather-icon"></i>
                            </div>
                            <div class="current-info">
                                <div class="current-temp" id="current-temp">--°</div>
                                <div class="current-condition" id="current-condition">Loading...</div>
                                <div class="current-location" id="current-location">📍 Getting location...</div>
                            </div>
                        </div>
                        
                        <div class="current-details">
                            <div class="detail-item">
                                <span class="detail-label">Feels Like</span>
                                <span class="detail-value" id="feels-like">--°</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Humidity</span>
                                <span class="detail-value" id="humidity">--%</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Wind</span>
                                <span class="detail-value" id="wind-speed">-- mph</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 7-Day Forecast -->
                    <div class="weather-forecast">
                        <h3>Forecast</h3>
                        <div class="forecast-grid" id="forecast-grid">
                            <!-- Forecast items will be populated here -->
                        </div>
                    </div>
                    
                    <div class="weather-actions">
                        <button type="button" id="refresh-weather-btn" class="secondary-btn">
                            <svg viewBox="0 0 24 24" width="16" height="16">
                                <polyline points="23 4 23 10 17 10" stroke="currentColor" stroke-width="2" fill="none"/>
                                <polyline points="1 20 1 14 7 14" stroke="currentColor" stroke-width="2" fill="none"/>
                                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15" stroke="currentColor" stroke-width="2" fill="none"/>
                            </svg>
                            Refresh Weather
                        </button>
                    </div>
                </div>
                
                <div id="weather-error" class="weather-error hidden">
                    <div class="error-icon">⚠️</div>
                    <h3>Unable to get weather data</h3>
                    <p id="weather-error-message">Please check your API key configuration.</p>
                    <button type="button" id="retry-weather-btn" class="primary-btn">Try Again</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Planning Assistant Panel -->
    <div class="assistant-panel" id="assistant-panel">
        <div class="assistant-header">
            <div class="assistant-title">
                <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                <span>Planno Assistant</span>
            </div>
            <button class="assistant-close" id="assistant-close" aria-label="Close Assistant">
                <svg viewBox="0 0 24 24" width="20" height="20">
                    <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                    <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                </svg>
            </button>
        </div>
        
        <div class="assistant-chat" id="assistant-chat">
            <div class="assistant-welcome">
                <div class="welcome-icon">
                    <svg viewBox="0 0 24 24" width="40" height="40" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <h3>How can I help you today?</h3>
                <p>Ask me about your schedule, tasks, or nearby places.</p>
                <div class="quick-suggestions">
                    <button class="quick-suggestion">"Plan my morning"</button>
                    <button class="quick-suggestion">"Break down a task"</button>
                    <button class="quick-suggestion">"Find restaurants nearby"</button>
                    <button class="quick-suggestion">"Dog-friendly places"</button>
                </div>
            </div>
        </div>
        
        <div class="assistant-input">
            <div class="input-container">
                <input type="text" id="assistant-input" placeholder="Ask me anything..." autocomplete="off">
                <button class="send-btn" id="assistant-send" title="Send">
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notification-container" class="notification-container"></div>

    <!-- Add Class Modal -->
    <div id="add-class-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>📚 Add Class</h3>
                <button class="modal-close" type="button" aria-label="Close">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="add-class-form">
                    <div class="form-group">
                        <label for="class-name">Class Name *</label>
                        <input type="text" id="class-name" placeholder="e.g., Introduction to Computer Science" required />
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="class-code">Course Code</label>
                            <input type="text" id="class-code" placeholder="e.g., CS 101" />
                        </div>
                        <div class="form-group">
                            <label for="class-credits">Credits</label>
                            <input type="number" id="class-credits" min="1" max="10" placeholder="3" />
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="class-professor">Professor</label>
                        <input type="text" id="class-professor" placeholder="Dr. Smith" />
                    </div>

                    <div class="form-group">
                        <label for="class-location">Location</label>
                        <input type="text" id="class-location" placeholder="Room 101, Science Building" />
                    </div>

                    <div class="form-group">
                        <label>Days of Week *</label>
                        <div class="days-selector">
                            <label class="day-checkbox">
                                <input type="checkbox" name="class-days" value="Monday" />
                                <span>Mon</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="class-days" value="Tuesday" />
                                <span>Tue</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="class-days" value="Wednesday" />
                                <span>Wed</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="class-days" value="Thursday" />
                                <span>Thu</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="class-days" value="Friday" />
                                <span>Fri</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="class-days" value="Saturday" />
                                <span>Sat</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="class-days" value="Sunday" />
                                <span>Sun</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="class-start-time">Start Time *</label>
                            <input type="time" id="class-start-time" required />
                        </div>
                        <div class="form-group">
                            <label for="class-end-time">End Time *</label>
                            <input type="time" id="class-end-time" required />
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="class-color">Class Color</label>
                        <div class="color-picker">
                            <input type="color" id="class-color" value="#4A90E2" />
                            <span class="color-preview"></span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="modal-cancel">Cancel</button>
                <button type="button" id="save-class-btn" class="modal-save">Save Class</button>
            </div>
        </div>
    </div>

    <!-- Edit Class Modal -->
    <div id="edit-class-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Class</h3>
                <button class="modal-close" type="button" aria-label="Close">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="edit-class-form">
                    <div class="form-group">
                        <label for="edit-class-name">Class Name *</label>
                        <input type="text" id="edit-class-name" placeholder="e.g., Introduction to Computer Science" required />
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="edit-class-code">Course Code</label>
                            <input type="text" id="edit-class-code" placeholder="e.g., CS 101" />
                        </div>
                        <div class="form-group">
                            <label for="edit-class-credits">Credits</label>
                            <input type="number" id="edit-class-credits" min="1" max="10" placeholder="3" />
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="edit-class-professor">Professor</label>
                        <input type="text" id="edit-class-professor" placeholder="Dr. Smith" />
                    </div>

                    <div class="form-group">
                        <label for="edit-class-location">Location</label>
                        <input type="text" id="edit-class-location" placeholder="Room 101, Science Building" />
                    </div>

                    <div class="form-group">
                        <label>Days of Week *</label>
                        <div class="days-selector">
                            <label class="day-checkbox">
                                <input type="checkbox" name="edit-class-days" value="Monday" />
                                <span>Mon</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="edit-class-days" value="Tuesday" />
                                <span>Tue</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="edit-class-days" value="Wednesday" />
                                <span>Wed</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="edit-class-days" value="Thursday" />
                                <span>Thu</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="edit-class-days" value="Friday" />
                                <span>Fri</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="edit-class-days" value="Saturday" />
                                <span>Sat</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="edit-class-days" value="Sunday" />
                                <span>Sun</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="edit-class-start-time">Start Time *</label>
                            <input type="time" id="edit-class-start-time" required />
                        </div>
                        <div class="form-group">
                            <label for="edit-class-end-time">End Time *</label>
                            <input type="time" id="edit-class-end-time" required />
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="edit-class-color">Class Color</label>
                        <div class="color-picker">
                            <input type="color" id="edit-class-color" value="#4A90E2" />
                            <span class="color-preview"></span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="modal-cancel">Cancel</button>
                <button type="button" id="update-class-btn" class="modal-save">Update Class</button>
            </div>
        </div>
    </div>

    <!-- Add Break Modal -->
    <div id="add-break-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>☕ Add Break Period</h3>
                <button class="modal-close" type="button" aria-label="Close">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="add-break-form">
                    <div class="form-group">
                        <label for="break-name">Break Name *</label>
                        <input type="text" id="break-name" placeholder="e.g., Spring Break, Thanksgiving" required />
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="break-start">Start Date *</label>
                            <input type="date" id="break-start" required />
                        </div>
                        <div class="form-group">
                            <label for="break-end">End Date *</label>
                            <input type="date" id="break-end" required />
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="modal-cancel">Cancel</button>
                <button type="button" id="save-break-btn" class="modal-save">Save Break</button>
            </div>
        </div>
    </div>

    <!-- Custom Confirmation Modal -->
    <div id="confirmation-modal" class="confirmation-modal-overlay">
        <div class="confirmation-modal">
            <div class="confirmation-modal-header">
                <div class="confirmation-icon">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
                        <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
                        <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <h3 id="confirmation-title">Confirm Action</h3>
            </div>
            <div class="confirmation-modal-body">
                <p id="confirmation-message">Are you sure you want to proceed?</p>
            </div>
            <div class="confirmation-modal-footer">
                <button type="button" id="confirmation-cancel" class="confirmation-btn confirmation-btn-cancel">
                    <svg viewBox="0 0 24 24" width="16" height="16">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span>Cancel</span>
                </button>
                <button type="button" id="confirmation-confirm" class="confirmation-btn confirmation-btn-confirm">
                    <svg viewBox="0 0 24 24" width="16" height="16">
                        <polyline points="20 6 9 17 4 12" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                    <span id="confirmation-confirm-text">Confirm</span>
                </button>
            </div>
        </div>
    </div>

    <script src="static/push-notifications.js"></script>
    <script src="static/script.js"></script>
</body>
</html>